# Reflection â€”â€” åå°„

## <font color="pink" face="æ±‰ä»ªè¿ªå‡è‹±é›„ä½“, æ¥·ä½“">ä¸€æ—¶åå°„ä¸€æ—¶çˆ½ï¼Œä¸€ç›´åå°„ä¸€ç›´çˆ½</font>

### è·å–å±æ€§ä¿¡æ¯

```csharp
 Type compareInfoType = typeof(CompareItem);
 PropertyInfo[] properties = compareInfoType.GetProperties();
```

éšåå¯é€šè¿‡`properties[i].Name`è·å–å±æ€§åï¼Œ`properties[i].GetValue(obj)`è·å–å±æ€§å€¼ï¼ˆå…¶ä¸­`obj`ï¼‰æ˜¯å…·ä½“çš„å®ä¾‹

### åˆ›å»ºå¯¹è±¡

é€šè¿‡åå°„åˆ›å»ºå¯¹è±¡ï¼Œéœ€è¦è·å–æ„é€ å‡½æ•°ä¿¡æ¯ï¼Œå¹¶è°ƒç”¨æ„é€ å‡½æ•°çš„`Invoke`æ–¹æ³•ï¼Œä¼ å…¥å‚æ•°ï¼Œå³å¯åˆ›å»ºå¯¹è±¡

ä¸‹é¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œ`CreateInstance`æ–¹æ³•è¦é€šè¿‡`dataRow`ä¸­çš„æ•°æ®ï¼Œä½¿ç”¨åå°„åˆ›å»º`T`ç±»å‹çš„å¯¹è±¡

```csharp
 public static T CreateInstance<T>(DataRow dataRow)
 {
     Type type = typeof(T);
     ConstructorInfo constructorInfo = type.GetConstructor(new Type[] { });
     if(constructorInfo != null)
     {
         //è°ƒç”¨ç±»çš„æ— å‚æ„é€ å‡½æ•°åˆ›å»ºå¯¹è±¡
         T instance = (T)constructorInfo.Invoke(new object[] { });
         PropertyInfo[] properties = type.GetProperties();
         foreach(PropertyInfo property in properties)
         {
             if (dataRow.Table.Columns.Contains(property.Name) 
                 && dataRow.Table.Columns[property.Name].DataType == property.PropertyType)
             {
                 property.SetValue(instance, dataRow[property.Name]);
             }
         }
         return instance;
     }
     return default(T);
 }
```
å¦‚æœæ˜¯æœ‰å‚æ„é€ å‡½æ•°ï¼Œåˆ™å°†`type.GetConstructor(new Type[] { })`ä¸­çš„å‚æ•°ç±»å‹æ¢æˆæ„é€ å‡½æ•°çš„å‚æ•°ç±»å‹å³å¯
å¦‚ï¼š

```csharp
public class ExampleClass
{
    public int Id { get; set; }
    public string Name { get; set; }

    // æœ‰å‚æ„é€ å‡½æ•°
    public ExampleClass(int id, string name)
    {
        Id = id;
        Name = name;
    }
}
```

å¯é€šè¿‡ä»¥ä¸‹ä»£ç è·å–æœ‰å‚æ„é€ å‡½æ•°ä¿¡æ¯

```csharp
ConstructorInfo constructorInfo = type.GetConstructor(new Type[] { typeof(int), typeof(string) });
```

### <font color="red" face="æ¥·ä½“">è‡³äºå…¶ä»–å…³äºæ–¹æ³•çš„åå°„ï¼Œç­‰ç”¨åˆ°çš„æ—¶å€™å†è®°å½•</font> ğŸ‘½

